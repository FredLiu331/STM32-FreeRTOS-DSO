# STM32 FreeRTOS Digital Oscilloscope

本项目是一款基于 **STM32F103ZET6** (正点原子精英板 V2)的嵌入式数字示波器。

## 🚀 核心架构设计

项目采用 **生产者-消费者 (Producer-Consumer)** 模型，通过任务优先级和通信机制解耦了高速采样与低速 UI 刷新之间的矛盾：

1.  **生产者 (Scope Core)**: 利用 ADC+DMA 循环模式持续采集数据，通过 **Task Notifications** 实时通知处理任务。
2.  **消费者 (GUI & Recorder)**: 
    * **GUI 任务**：通过 LVGL 刷新图表，利用双缓冲机制确保显示不撕裂。
    * **录制任务**：采用异步状态机，将采样数据存入环形队列并分批写入 SPI Flash。

## ✨ 功能特性

* **实时波形采集**: 支持最高 **1Msps** 采样率（当前预设档位 50Hz - 100kHz），具备双缓冲零拷贝架构。
* **频谱分析 (FFT)**: 集成 CMSIS-DSP 库，支持 256 点实时 FFT 变换，实时显示信号频域特征。
* **触发与测量**:
    * 支持上升沿触发，内置动态迟滞（Hysteresis）算法。
    * 自动计算 Vmax, Vmin, Vrms, 频率及占空比。
* **DDS 信号发生器**: 利用 DAC + DMA + TIM6 输出正弦波、方波和三角波。
* **波形录制与回放**: 支持将采集数据实时写入 W25Q128 Flash，支持断电保存后的离线回放与波形滚动预览。
* **系统监控**: 实时统计 CPU 占用率与任务堆栈水位线，确保在高负载工况下的系统稳定性。

## 🛠️ 硬件连接 (精英V2 开发板)

根据硬件手册，核心外设配置如下：

| 功能 | 引脚 | 描述 |
| :--- | :--- | :--- |
| **ADC 输入** | PA1 | 信号输入 (ADC1_CH1) |
| **DAC 输出** | PA4 | 信号源输出 (DAC_CH1) |
| **Flash 片选** | PB12 | SPI2 外置 Flash |
| **LCD 接口** | FSMC | 16位并行总线 |
| **遥控接收** | PB9 | 红外遥控输入 |
